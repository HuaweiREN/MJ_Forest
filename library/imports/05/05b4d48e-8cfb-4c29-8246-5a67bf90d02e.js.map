{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\ContentScript/assets\\Script\\ContentScript\\cPetInfo.js"],"names":["cc","Class","extends","Component","properties","PrtName","TalentIntro","_bgNode","_goBackFlag","start","onShow","FabInfo","PetName","node","getChildByName","setName","setTalent","listenToSwitch","active","onHide","removeFromParent","petName","getComponent","Label","petSelfie","Sprite","petIntroText","spriteFrame","GlobalFuncVar","preloadList","iconPackPS","getSpriteFrame","string","sysPetIntro","dayu","duoduo","huanhuan","maiqi","onClickBackToDict","nodePrt","childrenCount","j","petTalentPool","put","children","petTalentTemp","sysPetTalentText","count","i","length","size","RankItem","get","instantiate","petTalent","addChild","TalentIntroText","color","Color","userPetInfo","petLevel","on","Node","EventType","TOUCH_END","event","bind","update","dt","off"],"mappings":"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","file":"cPetInfo.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\ContentScript","sourcesContent":["\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        PrtName: null,\r\n        TalentIntro: null,\r\n        _bgNode: null,\r\n        _goBackFlag: false,\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    onShow: function(PrtName, FabInfo, PetName){\r\n        this.PrtName = PrtName;\r\n        this._bgNode = this.node.getChildByName(\"bg\");\r\n        this.setName(PetName);\r\n        this.setTalent(PetName);\r\n        this.listenToSwitch();\r\n        this.node.active = true;\r\n    },\r\n\r\n    onHide: function(){\r\n        this.node.active = false;\r\n        this.PrtName.active = true;\r\n        this.node.removeFromParent(true);\r\n    },\r\n\r\n    setName: function(PetName){\r\n        let petName = this.node.getChildByName(\"titleBg\").getChildByName(\"petName\").getComponent(cc.Label);\r\n        let petSelfie = this.node.getChildByName(\"petIntro\").getChildByName(\"petSelfie\").getComponent(cc.Sprite);\r\n        let petIntroText = this.node.getChildByName(\"petIntro\").getComponent(cc.Label);\r\n\r\n        if(PetName == \"dayu\"){\r\n            \r\n            petSelfie.spriteFrame = GlobalFuncVar.preloadList.iconPackPS.getSpriteFrame(\"dayuSelfiePS\");\r\n            petIntroText.string = GlobalFuncVar.sysPetIntro.dayu;\r\n            //petName.string = \"大宇\";\r\n        } else if (PetName == \"duoduo\") {\r\n            petSelfie.spriteFrame = GlobalFuncVar.preloadList.iconPackPS.getSpriteFrame(\"duoduoSelfiePS\");\r\n            petIntroText.string = GlobalFuncVar.sysPetIntro.duoduo;\r\n            //petName.string = \"朵朵\";\r\n        } else if (PetName == \"huanhuan\") {\r\n            petSelfie.spriteFrame = GlobalFuncVar.preloadList.iconPackPS.getSpriteFrame(\"huanhuanSelfiePS\");\r\n            petIntroText.string = GlobalFuncVar.sysPetIntro.huanhuan;\r\n            //petName.string = \"欢欢\";\r\n        } else if (PetName == \"maiqi\") {\r\n            petSelfie.spriteFrame = GlobalFuncVar.preloadList.iconPackPS.getSpriteFrame(\"maiqiSelfiePS\");\r\n            petIntroText.string = GlobalFuncVar.sysPetIntro.maiqi;\r\n            //petName.string = \"麦奇\";\r\n        };\r\n    },\r\n\r\n    //// 20200302\r\n    onClickBackToDict(){\r\n\r\n        // 除去scrollview上的子节点，并且放入节点池中\r\n        var nodePrt = this.node.getChildByName(\"petTalent\").getChildByName(\"view\").getChildByName(\"content\");\r\n        var childrenCount = nodePrt.childrenCount;\r\n        for (let j=0; j<childrenCount; j++){\r\n            //console.log(\"First element in the array: \", nodePrt.children[0]);\r\n            GlobalFuncVar.preloadList.petTalentPool.put(nodePrt.children[0]);\r\n            //console.log(\"Nodepool element left: \", GlobalFuncVar.preloadList.petTalentPool.size());\r\n        }\r\n\r\n        this.onHide();\r\n    },\r\n\r\n    //// 20200302\r\n    setTalent(PetName){\r\n        var nodePrt = this.node.getChildByName(\"petTalent\").getChildByName(\"view\").getChildByName(\"content\");\r\n        var petTalentTemp = null;\r\n        if(PetName == \"dayu\"){\r\n            petTalentTemp = GlobalFuncVar.sysPetTalentText.dayu;\r\n        } else if (PetName == \"duoduo\") {\r\n            petTalentTemp = GlobalFuncVar.sysPetTalentText.duoduo;\r\n        } else if (PetName == \"huanhuan\") {\r\n            petTalentTemp = GlobalFuncVar.sysPetTalentText.huanhuan;\r\n        } else if (PetName == \"maiqi\") {\r\n            petTalentTemp = GlobalFuncVar.sysPetTalentText.maiqi;\r\n        };\r\n        \r\n        let count = 0;\r\n        for (let i=0;i<petTalentTemp.length;i++){\r\n\r\n            if (GlobalFuncVar.preloadList.petTalentPool.size() > 0) { // 通过 size 接口判断对象池中是否有空闲的对象\r\n                //console.log(\"Nodepool element left: \", GlobalFuncVar.preloadList.petTalentPool.size());\r\n                var RankItem = GlobalFuncVar.preloadList.petTalentPool.get();\r\n            } else { // 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建\r\n                var RankItem = cc.instantiate(GlobalFuncVar.preloadList.petTalent);\r\n                //console.log(\"Nodepool element left: \", GlobalFuncVar.preloadList.petTalentPool.size());\r\n            }\r\n\r\n            let TalentIntro = RankItem;\r\n            nodePrt.addChild(TalentIntro,0,\"TalentIntro\"+count);\r\n            let TalentIntroText = nodePrt.getChildByName(\"TalentIntro\"+count);\r\n            TalentIntroText.color = new cc.Color(96, 80, 44);\r\n            TalentIntroText = TalentIntroText.getComponent(cc.Label);\r\n            if (count < GlobalFuncVar.userPetInfo.petLevel+20){\r\n                TalentIntroText.string = \"    \" + petTalentTemp[count];\r\n            } else {\r\n                TalentIntroText.string = \"    待解锁\";\r\n            }\r\n            \r\n            count += 1;\r\n\r\n            /*\r\n            cc.loader.loadRes(\"/Element/TalentIntro\", function(err, prefab){\r\n                if (err) {return console.log(\"cannot find element: TalentIntro\")};\r\n                let TalentIntro = cc.instantiate(prefab);\r\n                nodePrt.addChild(TalentIntro,0,\"TalentIntro\"+count);\r\n                let TalentIntroText = nodePrt.getChildByName(\"TalentIntro\"+count);\r\n                TalentIntroText.color = new cc.Color(96, 80, 44);\r\n                TalentIntroText = TalentIntroText.getComponent(cc.Label);\r\n                TalentIntroText.string = petTalentTemp[count];\r\n                count += 1;\r\n            }.bind(this))\r\n            */\r\n        };\r\n    },\r\n\r\n    //// 20200302\r\n    listenToSwitch(){\r\n        this.node.getChildByName(\"maskLayer\").on(cc.Node.EventType.TOUCH_END, function (event){\r\n            this._goBackFlag = true;\r\n        }.bind(this), this);\r\n    },\r\n\r\n    //// 20200302\r\n    update (dt) {\r\n        if (this._goBackFlag == true){\r\n            this.onClickBackToDict();\r\n            this.node.getChildByName(\"maskLayer\").off(cc.Node.EventType.TOUCH_END);\r\n            this._goBackFlag = false;\r\n        };\r\n    }\r\n});\r\n"]}